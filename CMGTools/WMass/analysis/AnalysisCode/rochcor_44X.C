#include <rochcor_44X.h>
#include <TLorentzVector.h>


const float rochcor44X::netabin[23]={-2.4,-2.1,-1.85,-1.6,-1.4,-1.2,-1.0,-0.8,-0.6,-0.4,-0.2,
				  0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.4};



const float rochcor44X::dcor_bfA[8][22]={{-0.000022195,-0.000015598,0.000084865,-0.000083813,-0.000025229,-0.000038293,0.000015959,-0.000040716,
				       -0.000052348,-0.000119383,-0.000128294,-0.000045691,0.000037568,-0.000067299,-0.000030313,0.000020984,
				       -0.000025341,-0.000082893,-0.000103505,0.000002029,-0.000082571,-0.000050532},
				      {0.000086242,-0.000007202,0.000048251,0.000098823,-0.000012375,-0.000022240,-0.000007099,-0.000061044,
				       -0.000097653,0.000002898,-0.000043714,-0.000051471,-0.000074285,-0.000068752,-0.000085191,-0.000058494,
				       -0.000024999,0.000056473,0.000019010,-0.000043971,-0.000019550,0.000054519},
				      {0.000067285,0.000057193,-0.000034380,0.000027202,-0.000005905,0.000010450,-0.000024389,-0.000051097,
				       -0.000060048,0.000068515,-0.000076395,-0.000036327,-0.000107472,-0.000057240,0.000005690,-0.000046126,
				       -0.000056717,-0.000052745,0.000009274,0.000087086,0.000009164,0.000043463},
				      {-0.000096441,-0.000098724,-0.000023598,-0.000045374,-0.000000375,-0.000053760,-0.000009757,-0.000068214,
				       0.000009643,-0.000144917,-0.000138528,-0.000044212,-0.000097345,-0.000078260,0.000013903,-0.000052625,
				       -0.000032414,-0.000072293,-0.000035954,-0.000028970,0.000000212,0.000003546},
				      {-0.000047213,-0.000021487,-0.000025974,0.000026429,-0.000004924,-0.000045283,-0.000025085,-0.000029220,
				       0.000001926,-0.000019659,-0.000095425,-0.000075850,0.000025265,-0.000099478,-0.000052059,-0.000038025,
				       -0.000047455,-0.000094330,-0.000040101,0.000054248,-0.000132311,0.000093546},
				      {-0.000051763,-0.000183970,-0.000077780,-0.000108889,-0.000095660,-0.000026370,-0.000120459,-0.000060066,
				       -0.000033951,-0.000005123,-0.000128502,-0.000037895,-0.000016665,-0.000080856,-0.000087267,-0.000025926,
				       -0.000111663,0.000021708,-0.000122257,-0.000068459,-0.000035033,-0.000033338},
				      {-0.000150210,-0.000103955,-0.000042577,-0.000123824,-0.000003392,-0.000042545,-0.000135665,-0.000043166,
				       -0.000066213,-0.000062652,-0.000045456,-0.000010989,-0.000063081,-0.000076281,0.000016499,-0.000045665,
				       0.000025697,-0.000039415,-0.000119719,-0.000007920,-0.000102025,-0.000022604},
				      {-0.000063987,-0.000121632,-0.000077751,-0.000030332,-0.000035060,-0.000009333,-0.000017660,-0.000002622,
				       -0.000023953,-0.000088675,-0.000013912,-0.000068872,-0.000067567,-0.000079119,-0.000024469,-0.000021548,
				       -0.000017080,-0.000052932,-0.000096960,-0.000014549,-0.000001031,0.000054701}};
const float rochcor44X::dcor_maA[8][22]={{0.000403861,0.000122468,0.000090004,-0.000029667,-0.000051811,-0.000069657,-0.000074266,-0.000041420,
				       -0.000029966,-0.000117558,-0.000142386,-0.000111552,-0.000133080,-0.000066490,-0.000063571,-0.000107796,
				       -0.000161832,-0.000080958,-0.000043024,0.000131047,0.000430855,0.000734183},
				      {0.000918341,0.000453220,0.000138221,0.000113903,-0.000030904,-0.000011447,-0.000049084,0.000007963,-0.000001265,
				       -0.000035248,-0.000013914,-0.000064180,-0.000029107,-0.000032085,-0.000053100,0.000011223,-0.000075602,0.000056881,
				       0.000028663,-0.000032415,-0.000089370,-0.000028499},
				      {-0.000063726,0.000013906,0.000038544,0.000096805,0.000032991,0.000076601,0.000034942,0.000100095,0.000163378,
				       0.000117855,0.000051534,0.000106609,0.000028203,0.000014447,0.000086280,-0.000042873,0.000017072,0.000015274,
				       0.000009321,-0.000017827,-0.000191855,-0.000234640},
				      {-0.001131615,-0.000416331,-0.000120800,0.000148451,0.000154838,0.000167939,0.000213245,0.000203981,0.000107315,
				       0.000173934,0.000251207,0.000082661,0.000081815,0.000099612,0.000127641,0.000083759,0.000098858,0.000042499,
				       0.000031304,-0.000089165,-0.000044083,-0.000224619},
				      {-0.000964129,-0.000416258,-0.000037711,0.000164690,0.000214155,0.000226597,0.000117415,0.000160043,0.000135600,
				       0.000123307,0.000093799,0.000149998,0.000169833,0.000133746,0.000096671,0.000118556,0.000105615,0.000120005,
				       0.000136149,0.000050418,-0.000024087,-0.000306825},
				      {-0.000371197,-0.000201347,-0.000077117,0.000072154,0.000039588,-0.000005647,-0.000038863,-0.000011611,0.000008583,
				       0.000051451,-0.000022653,0.000051066,0.000034216,0.000024250,-0.000060939,-0.000010885,0.000049105,0.000101157,
				       0.000097642,0.000118561,0.000130622,-0.000200810},
				      {0.000230046,0.000077409,-0.000042054,-0.000017631,-0.000110378,-0.000082534,-0.000042227,-0.000085398,-0.000072820,
				       -0.000124948,-0.000096456,-0.000089525,-0.000101769,-0.000171408,-0.000132339,-0.000104095,-0.000126292,-0.000175673,
				       -0.000201003,-0.000082778,0.000026598,0.000554926},
				      {0.000142195,0.000094958,0.000023204,-0.000024151,-0.000073297,0.000004275,-0.000080421,-0.000164769,-0.000189535,
				       -0.000111796,-0.000160351,-0.000174854,-0.000229502,-0.000157320,-0.000233266,-0.000245364,-0.000292551,-0.000254458,
				       -0.000215435,-0.000063532,0.000231320,0.000886362}};


const float rochcor44X::mcor_bfA[8][22]={{-0.000078142,-0.000040452,-0.000055370,-0.000037177,-0.000031324,0.000009393,0.000018909,0.000049580,0.000028934,
				       0.000025085,0.000035098,0.000026304,0.000047645,0.000012872,0.000019879,0.000024345,0.000017860,-0.000013890,
				       -0.000023330,-0.000126405,-0.000108755,-0.000105300},
				      {-0.000062671,0.000008931,-0.000013535,0.000014556,0.000036627,-0.000010701,0.000034653,-0.000029727,0.000015214,
				       -0.000013231,-0.000034500,-0.000057192,-0.000039336,-0.000030579,-0.000014393,-0.000024989,-0.000011073,0.000028069,
				       0.000031487,-0.000026663,0.000042030,0.000003450},
				      {-0.000041327,-0.000030942,-0.000015519,-0.000059360,0.000027583,-0.000005393,0.000024777,-0.000025988,-0.000030856,
				       -0.000013485,-0.000017239,-0.000053665,0.000000370,-0.000031027,-0.000049804,-0.000024300,-0.000046889,0.000022823,
				       0.000030835,-0.000020928,-0.000007564,-0.000033919},
				      {-0.000057764,-0.000041090,-0.000097158,-0.000006175,-0.000000414,0.000029805,0.000030695,-0.000006226,0.000020162,
				       -0.000001825,-0.000042966,-0.000021253,-0.000088242,-0.000037734,-0.000024643,-0.000007936,-0.000030727,0.000022174,
				       0.000032737,-0.000023411,0.000010772,-0.000048932},
				      {-0.000047612,-0.000061771,-0.000021902,-0.000041568,-0.000027637,0.000043614,0.000018755,0.000034586,0.000035741,
				       0.000097063,0.000029505,0.000040748,-0.000001510,-0.000000577,0.000002028,-0.000039066,-0.000030642,-0.000007596,
				       -0.000026950,0.000027548,-0.000011034,-0.000047164},
				      {-0.000046817,-0.000077825,-0.000034565,-0.000074085,-0.000042568,0.000032881,0.000040269,0.000055516,0.000037093,
				       0.000000261,0.000060848,0.000018400,0.000025391,0.000032009,0.000031754,-0.000025827,-0.000016369,-0.000038983,
				       0.000000856,-0.000041432,-0.000021773,-0.000031934},
				      {-0.000117559,-0.000099461,-0.000036283,-0.000080948,-0.000058857,0.000010565,0.000049159,0.000034088,0.000038457,
				       0.000049413,0.000054389,0.000037480,0.000022817,-0.000005790,0.000028750,-0.000027089,0.000008510,-0.000038357,
				       -0.000046564,-0.000042124,-0.000061150,-0.000029080},
				      {-0.000043295,-0.000006322,0.000008191,-0.000021206,-0.000003780,-0.000023849,-0.000016502,-0.000023676,-0.000011256,
				       -0.000033079,-0.000008335,-0.000029575,-0.000016035,-0.000021894,-0.000049054,0.000017808,-0.000005848,0.000018517,
				       0.000004687,-0.000017429,-0.000051287,-0.000031716}};

const float rochcor44X::mcor_maA[8][22]={{0.000910474,0.000433865,0.000052203,-0.000100739,-0.000186710,-0.000163242,-0.000173055,-0.000188989,-0.000152840,
				       -0.000186865,-0.000176979,-0.000170624,-0.000167554,-0.000168601,-0.000127328,-0.000178371,-0.000177132,-0.000225912,
				       -0.000173899,0.000097777,0.000149295,0.000137635},
				      {0.001018222,0.000193335,-0.000033165,-0.000143097,-0.000108816,-0.000101567,-0.000112024,-0.000080549,-0.000093412,-0.000083127,
				       -0.000101669,-0.000100041,-0.000073086,-0.000093910,-0.000057659,-0.000057906,-0.000035211,-0.000044433,-0.000057734,0.000186831,
				       0.000456567,0.000754928},
				      {0.000495164,-0.000042806,-0.000058962,-0.000009378,0.000003010,0.000004611,0.000012436,0.000022770,0.000029385,0.000067292,
				       0.000021492,0.000060639,0.000003755,0.000019195,0.000022786,0.000023087,0.000109370,0.000093634,0.000097926,0.000029729,
				       0.000070707,0.000002271},
				      {0.000642521,0.000599888,0.000330490,0.000295180,0.000243677,0.000163190,0.000158253,0.000125731,0.000118239,0.000127886,
				       0.000131006,0.000120904,0.000173797,0.000156729,0.000135548,0.000108550,0.000142362,0.000173347,0.000259661,0.000306074,
				       0.000395595,0.000328830},
				      {0.000807766,0.000611758,0.000492495,0.000321847,0.000261830,0.000240513,0.000164826,0.000147705,0.000148692,0.000125463,
				       0.000169301,0.000162014,0.000177696,0.000174894,0.000173847,0.000158110,0.000147997,0.000155766,0.000193641,0.000337758,
				       0.000437248,0.000962184},
				      {-0.001183520,-0.000402051,-0.000081342,0.000031951,0.000096291,0.000082928,0.000106861,0.000106010,0.000099041,0.000111663,
				       0.000071462,0.000105444,0.000075782,0.000090427,0.000104537,0.000082418,0.000067290,0.000036522,0.000047319,0.000155692,
				       0.000226062,0.000786314},
				      {-0.001688799,-0.000597799,-0.000296734,-0.000040677,-0.000034778,-0.000034029,-0.000023414,-0.000034889,-0.000008270,
				       -0.000038105,-0.000022413,-0.000021239,-0.000054845,-0.000034208,-0.000049428,-0.000015765,-0.000073575,-0.000081245,
				       -0.000054096,-0.000115334,-0.000237080,-0.000230184},
				      {0.000392266,0.000274661,0.000099760,-0.000050393,-0.000144916,-0.000154194,-0.000114142,-0.000150305,-0.000109550,
				       -0.000112284,-0.000109027,-0.000109772,-0.000105219,-0.000138137,-0.000107730,-0.000115638,-0.000151452,-0.000105343,
				       -0.000305609,-0.000728334,-0.001251808,-0.002064952}};


const float rochcor44X::dcor_bfAer[8][22]={{0.000079256,0.000072222,0.000069696,0.000070040,0.000066152,0.000064809,0.000064043,0.000060193,
					 0.000059849,0.000060819,0.000060219,0.000059932,0.000060747,0.000062099,0.000060149,0.000064082,
					 0.000065696,0.000067162,0.000071144,0.000070079,0.000073067,0.000077305},
					{0.000073880,0.000071734,0.000066546,0.000069656,0.000068182,0.000065193,0.000062671,0.000060330,
					 0.000060707,0.000061473,0.000059328,0.000059911,0.000061463,0.000059015,0.000061308,0.000062724,
					 0.000066037,0.000068964,0.000071489,0.000067234,0.000071690,0.000073337},
					{0.000076308,0.000073904,0.000070022,0.000071004,0.000068000,0.000065632,0.000063255,0.000060432,
					 0.000059316,0.000060891,0.000060008,0.000060058,0.000060480,0.000059357,0.000060038,0.000063012,
					 0.000064374,0.000068438,0.000070951,0.000068250,0.000071002,0.000073924},
					{0.000073947,0.000073361,0.000069879,0.000069294,0.000066813,0.000063922,0.000062345,0.000060303,
					 0.000060061,0.000061160,0.000061118,0.000061105,0.000061534,0.000059563,0.000060031,0.000063504,
					 0.000064451,0.000067178,0.000070907,0.000066858,0.000071033,0.000072888},
					{0.000075850,0.000073368,0.000069058,0.000070426,0.000067332,0.000065720,0.000064566,0.000060224,
					 0.000059404,0.000060840,0.000060604,0.000060431,0.000060435,0.000059379,0.000060244,0.000062862,
					 0.000066446,0.000068876,0.000070065,0.000071236,0.000073712,0.000079979},
					{0.000073369,0.000071079,0.000066955,0.000069492,0.000066571,0.000065067,0.000062768,0.000059504,
					 0.000060088,0.000067632,0.000059502,0.000060273,0.000065760,0.000059531,0.000059648,0.000062024,
					 0.000065080,0.000066327,0.000069943,0.000069444,0.000071486,0.000073024},
					{0.000075689,0.000074063,0.000068883,0.000069376,0.000067230,0.000063105,0.000064101,0.000061272,
					 0.000059007,0.000061185,0.000060243,0.000058584,0.000066989,0.000059155,0.000060586,0.000062948,
					 0.000064088,0.000066882,0.000070070,0.000066941,0.000072849,0.000073662},
					{0.000074757,0.000072976,0.000069909,0.000070126,0.000066062,0.000064889,0.000063308,0.000060297,
					 0.000060201,0.000060824,0.000059824,0.000060300,0.000060694,0.000060088,0.000061023,0.000062422,
					 0.000063242,0.000068576,0.000073830,0.000066846,0.000071689,0.000073005}};
const float rochcor44X::dcor_maAer[8][22]={{0.000079256,0.000072222,0.000069696,0.000070040,0.000066152,0.000064809,0.000064043,0.000060193,
					 0.000059849,0.000060819,0.000060219,0.000059932,0.000060747,0.000062099,0.000060149,0.000064082,
					 0.000065696,0.000067162,0.000071144,0.000070079,0.000073067,0.000077305},
					{0.000073880,0.000071734,0.000066546,0.000069656,0.000068182,0.000065193,0.000062671,0.000060330,
					 0.000060707,0.000061473,0.000059328,0.000059911,0.000061463,0.000059015,0.000061308,0.000062724,
					 0.000066037,0.000068964,0.000071489,0.000067234,0.000071690,0.000073337},
					{0.000076308,0.000073904,0.000070022,0.000071004,0.000068000,0.000065632,0.000063255,0.000060432,
					 0.000059316,0.000060891,0.000060008,0.000060058,0.000060480,0.000059357,0.000060038,0.000063012,
					 0.000064374,0.000068438,0.000070951,0.000068250,0.000071002,0.000073924},
					{0.000073947,0.000073361,0.000069879,0.000069294,0.000066813,0.000063922,0.000062345,0.000060303,
					 0.000060061,0.000061160,0.000061118,0.000061105,0.000061534,0.000059563,0.000060031,0.000063504,
					 0.000064451,0.000067178,0.000070907,0.000066858,0.000071033,0.000072888},
					{0.000075850,0.000073368,0.000069058,0.000070426,0.000067332,0.000065720,0.000064566,0.000060224,
					 0.000059404,0.000060840,0.000060604,0.000060431,0.000060435,0.000059379,0.000060244,0.000062862,
					 0.000066446,0.000068876,0.000070065,0.000071236,0.000073712,0.000079979},
					{0.000073369,0.000071079,0.000066955,0.000069492,0.000066571,0.000065067,0.000062768,0.000059504,
					 0.000060088,0.000067632,0.000059502,0.000060273,0.000065760,0.000059531,0.000059648,0.000062024,
					 0.000065080,0.000066327,0.000069943,0.000069444,0.000071486,0.000073024},
					{0.000075689,0.000074063,0.000068883,0.000069376,0.000067230,0.000063105,0.000064101,0.000061272,
					 0.000059007,0.000061185,0.000060243,0.000058584,0.000066989,0.000059155,0.000060586,0.000062948,
					 0.000064088,0.000066882,0.000070070,0.000066941,0.000072849,0.000073662},
					{0.000074757,0.000072976,0.000069909,0.000070126,0.000066062,0.000064889,0.000063308,0.000060297,
					 0.000060201,0.000060824,0.000059824,0.000060300,0.000060694,0.000060088,0.000061023,0.000062422,
					 0.000063242,0.000068576,0.000073830,0.000066846,0.000071689,0.000073005}};


const float rochcor44X::mcor_bfAer[8][22]={{0.000034723,0.000031883,0.000029990,0.000031194,0.000029402,0.000027985,0.000026897,0.000026119,
					 0.000025806,0.000025973,0.000025645,0.000025835,0.000026082,0.000026039,0.000026305,0.000027487,
					 0.000028388,0.000029829,0.000031353,0.000031368,0.000032169,0.000033443},
					{0.000032579,0.000031469,0.000029829,0.000030966,0.000029455,0.000028607,0.000027382,0.000026449,
					 0.000026116,0.000026781,0.000025933,0.000026023,0.000026499,0.000026128,0.000026490,0.000027540,
					 0.000028584,0.000029376,0.000030858,0.000030479,0.000031451,0.000032379},
					{0.000032578,0.000031539,0.000030768,0.000030827,0.000029180,0.000028368,0.000027210,0.000026227,
					 0.000025964,0.000026641,0.000025997,0.000025766,0.000026791,0.000025913,0.000026323,0.000027440,
					 0.000028577,0.000029424,0.000031249,0.000029822,0.000031298,0.000032191},
					{0.000032754,0.000031578,0.000031219,0.000030746,0.000029057,0.000028058,0.000027028,0.000026035,
					 0.000025914,0.000026110,0.000025815,0.000025719,0.000026056,0.000025826,0.000026014,0.000027065,
					 0.000027924,0.000028907,0.000031071,0.000029306,0.000031255,0.000032233},
					{0.000032824,0.000031895,0.000030023,0.000031240,0.000029376,0.000028171,0.000027170,0.000026029,
					 0.000025886,0.000026204,0.000025693,0.000025810,0.000026099,0.000025706,0.000026292,0.000027141,
					 0.000028774,0.000029186,0.000030626,0.000032556,0.000032152,0.000035553},
					{0.000032461,0.000031586,0.000029987,0.000031133,0.000029257,0.000028343,0.000027253,0.000026195,
					 0.000025852,0.000028431,0.000025776,0.000025948,0.000027629,0.000025929,0.000026316,0.000027385,
					 0.000028396,0.000029173,0.000030787,0.000029904,0.000031594,0.000032337},
					{0.000032728,0.000031634,0.000030124,0.000030843,0.000029117,0.000028332,0.000027293,0.000026183,
					 0.000025919,0.000026332,0.000025967,0.000025949,0.000027398,0.000026014,0.000026265,0.000027186,
					 0.000028222,0.000029173,0.000030709,0.000029306,0.000031418,0.000032315},
					{0.000032694,0.000031657,0.000031245,0.000030807,0.000029275,0.000028079,0.000027186,0.000026021,
					 0.000025930,0.000025952,0.000025685,0.000025748,0.000026008,0.000025822,0.000026129,0.000026884,
					 0.000028057,0.000029492,0.000031599,0.000029380,0.000031082,0.000032497}};

const float rochcor44X::mcor_maAer[8][22]={{0.000034723,0.000031883,0.000029990,0.000031194,0.000029402,0.000027985,0.000026897,0.000026119,
					 0.000025806,0.000025973,0.000025645,0.000025835,0.000026082,0.000026039,0.000026305,0.000027487,
					 0.000028388,0.000029829,0.000031353,0.000031368,0.000032169,0.000033443},
					{0.000032579,0.000031469,0.000029829,0.000030966,0.000029455,0.000028607,0.000027382,0.000026449,
					 0.000026116,0.000026781,0.000025933,0.000026023,0.000026499,0.000026128,0.000026490,0.000027540,
					 0.000028584,0.000029376,0.000030858,0.000030479,0.000031451,0.000032379},
					{0.000032578,0.000031539,0.000030768,0.000030827,0.000029180,0.000028368,0.000027210,0.000026227,
					 0.000025964,0.000026641,0.000025997,0.000025766,0.000026791,0.000025913,0.000026323,0.000027440,
					 0.000028577,0.000029424,0.000031249,0.000029822,0.000031298,0.000032191},
					{0.000032754,0.000031578,0.000031219,0.000030746,0.000029057,0.000028058,0.000027028,0.000026035,
					 0.000025914,0.000026110,0.000025815,0.000025719,0.000026056,0.000025826,0.000026014,0.000027065,
					 0.000027924,0.000028907,0.000031071,0.000029306,0.000031255,0.000032233},
					{0.000032824,0.000031895,0.000030023,0.000031240,0.000029376,0.000028171,0.000027170,0.000026029,
					 0.000025886,0.000026204,0.000025693,0.000025810,0.000026099,0.000025706,0.000026292,0.000027141,
					 0.000028774,0.000029186,0.000030626,0.000032556,0.000032152,0.000035553},
					{0.000032461,0.000031586,0.000029987,0.000031133,0.000029257,0.000028343,0.000027253,0.000026195,
					 0.000025852,0.000028431,0.000025776,0.000025948,0.000027629,0.000025929,0.000026316,0.000027385,
					 0.000028396,0.000029173,0.000030787,0.000029904,0.000031594,0.000032337},
					{0.000032728,0.000031634,0.000030124,0.000030843,0.000029117,0.000028332,0.000027293,0.000026183,
					 0.000025919,0.000026332,0.000025967,0.000025949,0.000027398,0.000026014,0.000026265,0.000027186,
					 0.000028222,0.000029173,0.000030709,0.000029306,0.000031418,0.000032315},
					{0.000032694,0.000031657,0.000031245,0.000030807,0.000029275,0.000028079,0.000027186,0.000026021,
					 0.000025930,0.000025952,0.000025685,0.000025748,0.000026008,0.000025822,0.000026129,0.000026884,
					 0.000028057,0.000029492,0.000031599,0.000029380,0.000031082,0.000032497}};


//=======================================================================================================

const float rochcor44X::dmavgA[8][22]={{0.025984018,0.025106532,0.025029889,0.024838698,0.024768749,0.024876897,0.024884339,0.025292817,
				     0.025343997,0.025379736,0.025821343,0.025546554,0.025313690,0.025388683,0.025060129,0.024712527,
				     0.024515870,0.024911725,0.025286048,0.025099928,0.025884164,0.026635067},
				    {0.026202916,0.025557733,0.024969741,0.024685362,0.024959101,0.024960358,0.025063339,0.025271593,
				     0.025449922,0.025386457,0.025525086,0.025689923,0.025405410,0.025266230,0.025227452,0.025082343,
				     0.024995309,0.024900339,0.025117381,0.025036019,0.025325413,0.025514761},
				    {0.025820891,0.025278839,0.025467645,0.025085601,0.025138356,0.024913035,0.025051121,0.025405286,
				     0.025474602,0.025499567,0.025802958,0.025539453,0.025639829,0.025439314,0.025372573,0.025167261,
				     0.025284350,0.025140807,0.024901391,0.025252057,0.025129074,0.025352706},
				    {0.025337585,0.025205199,0.025046062,0.024993993,0.025015670,0.024764161,0.025259824,0.025295526,
				     0.025275647,0.025590240,0.025918478,0.025923300,0.025614431,0.025565788,0.025145337,0.025172837,
				     0.025056250,0.025136705,0.024937200,0.024982473,0.025451873,0.025775368},
				    {0.025156506,0.024833743,0.025023141,0.024936451,0.025069184,0.025228625,0.025101765,0.025370134,
				     0.025051426,0.025462340,0.025734444,0.025809933,0.025265067,0.025624498,0.025167106,0.025413029,
				     0.025239500,0.025136253,0.025056853,0.025073553,0.025427457,0.025550832},
				    {0.025528542,0.025143151,0.025057418,0.024929973,0.025168495,0.024867000,0.025033291,0.025281077,
				     0.025251106,0.025631318,0.025682404,0.025777116,0.025283480,0.025393989,0.025128904,0.024832171,
				     0.025077873,0.024811096,0.025204638,0.025223418,0.025416100,0.025592036},
				    {0.026176168,0.025083838,0.025042855,0.025219672,0.024773091,0.024902893,0.025360696,0.025224369,
				     0.025088092,0.025177709,0.025692202,0.025287183,0.025266402,0.025269132,0.024846226,0.024871682,
				     0.024904029,0.024674949,0.024885300,0.025056891,0.025451200,0.026284680},
				    {0.026245668,0.025389932,0.025489327,0.024883318,0.024925099,0.025022049,0.024917038,0.024814567,
				     0.025216773,0.025481371,0.025554965,0.025627964,0.025371730,0.025277230,0.024903203,0.024895396,
				     0.024778640,0.024908171,0.025088578,0.024960947,0.025372520,0.026248580}};

const float rochcor44X::dpavgA[8][22]={{0.025672467,0.025330316,0.024768522,0.025416641,0.024643985,0.024952697,0.024984210,0.025270675,
				     0.025495258,0.025563118,0.025986078,0.025307089,0.025530343,0.025428248,0.024989948,0.025096510,
				     0.024950757,0.025027450,0.025237669,0.025088521,0.025127405,0.025534755},
				    {0.024799203,0.024965386,0.024828198,0.024485728,0.024547112,0.025221541,0.024750646,0.025076593,
				     0.025491907,0.025697637,0.025733842,0.025477854,0.025751843,0.025579312,0.025419671,0.025165204,
				     0.025179539,0.024321430,0.024698090,0.025123800,0.025503304,0.025596265},
				    {0.025952305,0.025093383,0.025200855,0.024775892,0.024999710,0.024501118,0.025014779,0.025087399,
				     0.024965871,0.025639473,0.025638802,0.025495466,0.025388573,0.025529221,0.025087554,0.025233349,
				     0.025161209,0.024705380,0.025128233,0.024916180,0.025538672,0.025786183},
				    {0.026825688,0.026091870,0.025409675,0.024924848,0.024639552,0.024914927,0.024690070,0.024901945,
				     0.025265427,0.025800493,0.025404713,0.025645907,0.025483550,0.025341383,0.025081103,0.025093192,
				     0.024846232,0.024892870,0.025164687,0.025314043,0.025478427,0.025871799},
				    {0.026621908,0.025768903,0.025032045,0.025018818,0.024580401,0.024670281,0.024764895,0.025022705,
				     0.025211941,0.025559234,0.025609302,0.025534810,0.025215872,0.025449791,0.025026200,0.024936622,
				     0.024769417,0.024990262,0.025000930,0.025048924,0.025774228,0.025768650},
				    {0.026233252,0.025610454,0.025261874,0.024900529,0.024825100,0.025008004,0.025458126,0.024754081,
				     0.025627411,0.025292141,0.025741293,0.025428130,0.025447855,0.025376982,0.025590868,0.024868980,
				     0.025158933,0.024892064,0.025157771,0.025260998,0.025165862,0.025811251},
				    {0.025881606,0.025443941,0.025377395,0.025046289,0.024959195,0.025150061,0.025459217,0.025238827,
				     0.025453641,0.025739415,0.025573250,0.025640198,0.025532456,0.025696416,0.025123287,0.025121865,
				     0.024938356,0.025052283,0.025518664,0.025337349,0.025857860,0.025608976},
				    {0.025835851,0.025526901,0.025052157,0.024945621,0.024803859,0.024804078,0.024885240,0.024986845,
				     0.025669508,0.025855491,0.025497579,0.025702747,0.025857507,0.025582419,0.025594039,0.024974274,
				     0.025424341,0.025202147,0.025618797,0.025104013,0.025294306,0.025099776}};


const float rochcor44X::mmavgA[8][22]={{0.026715192,0.025900078,0.025287509,0.024965412,0.024885009,0.024853425,0.024892751,0.024949797,
				    0.025080270,0.025206151,0.025300136,0.025333139,0.025195947,0.025074547,0.024986038,0.024881408,
				    0.024778193,0.024841418,0.024967028,0.025436061,0.025703361,0.026184843},
				   {0.026790478,0.025580227,0.025180952,0.024862344,0.024859193,0.024889251,0.024909493,0.025115224,
				    0.025199307,0.025399953,0.025501543,0.025482503,0.025411478,0.025181337,0.025131714,0.025029864,
				    0.024928214,0.024921903,0.024961631,0.025394404,0.025833919,0.026562341},
				   {0.026357741,0.025458306,0.025177276,0.025067716,0.024980384,0.024960914,0.025062535,0.025212142,
				    0.025365416,0.025528677,0.025570200,0.025616142,0.025476835,0.025321410,0.025214725,0.025120336,
				    0.025085724,0.025051574,0.025065023,0.025250171,0.025463310,0.025915149},
				   {0.026524940,0.026015382,0.025563363,0.025306858,0.025217481,0.025089473,0.025124602,0.025250210,
				    0.025402747,0.025517701,0.025658651,0.025607703,0.025551688,0.025439982,0.025254243,0.025138946,
				    0.025105271,0.025111767,0.025236364,0.025506529,0.025829055,0.026235073},
				   {0.026621536,0.026061225,0.025673757,0.025348500,0.025235709,0.025121525,0.025169083,0.025215647,
				    0.025370223,0.025361340,0.025608533,0.025616616,0.025560882,0.025472443,0.025290339,0.025180413,
				    0.025120904,0.025156931,0.025236605,0.025481496,0.025864508,0.026768118},
				   {0.024948816,0.025123266,0.025171334,0.025093530,0.025103150,0.025007942,0.025143193,0.025204407,
				    0.025336652,0.025577798,0.025541215,0.025613883,0.025506110,0.025372379,0.025243097,0.025160307,
				    0.025025367,0.025067893,0.025075211,0.025384874,0.025685113,0.026587239},
				   {0.024662352,0.025064970,0.024987031,0.025066451,0.024995857,0.024916161,0.025003223,0.025114725,
				    0.025201706,0.025372214,0.025463873,0.025515411,0.025401401,0.025261121,0.025092017,0.025039124,
				    0.024895105,0.024940888,0.024986732,0.025137721,0.025273070,0.025735202},
				   {0.026344487,0.025729885,0.025332040,0.025069039,0.024883612,0.024824321,0.024968865,0.025005151,
				    0.025149630,0.025315863,0.025413666,0.025411699,0.025303971,0.025135199,0.025105082,0.024935883,
				    0.024870854,0.024911318,0.024763193,0.024600669,0.024503858,0.024240613}};

const float rochcor44X::mpavgA[8][22]={{0.025318569,0.025190468,0.025217298,0.025178377,0.025191442,0.025080464,0.025176092,0.025274993,
				    0.025381954,0.025488606,0.025651373,0.025656928,0.025513544,0.025376403,0.025242272,0.025161839,
				    0.025129048,0.025164968,0.025230414,0.025299805,0.025559368,0.026035983},
				   {0.025234149,0.025356487,0.025249215,0.025180021,0.025014001,0.025044208,0.025127200,0.025279051,
				    0.025394532,0.025522708,0.025702485,0.025690489,0.025538273,0.025381061,0.025174655,0.025131457,
				    0.024999314,0.024987352,0.025082925,0.025076463,0.025094505,0.025395443},
				   {0.025699972,0.025622006,0.025343158,0.025140260,0.024946681,0.024953994,0.024991331,0.025177334,
				    0.025295401,0.025456670,0.025537068,0.025563768,0.025449918,0.025297460,0.025234358,0.025028288,
				    0.024920900,0.024897953,0.024973176,0.025198455,0.025469020,0.025997081},
				   {0.025571787,0.025079230,0.025083161,0.024832801,0.024766613,0.024836432,0.024889154,0.025033934,
				    0.025154048,0.025322377,0.025466236,0.025437862,0.025348307,0.025141007,0.025024652,0.024941381,
				    0.024888590,0.024817779,0.024855950,0.025012603,0.025224219,0.025870535},
				   {0.025476210,0.025083485,0.024851838,0.024840959,0.024775742,0.024736445,0.024867175,0.024966177,
				    0.025093205,0.025245003,0.025357222,0.025368464,0.025276089,0.025113217,0.024984897,0.024949083,
				    0.024895944,0.024844591,0.024935023,0.024983847,0.025192062,0.025302699},
				   {0.026962043,0.025908364,0.025297764,0.025113493,0.024946783,0.024883222,0.024900269,0.025070694,
				    0.025170577,0.025352613,0.025459918,0.025439732,0.025411877,0.025193203,0.025052898,0.024966677,
				    0.024908884,0.024965586,0.025037836,0.025169626,0.025389608,0.025425925},
				   {0.027473904,0.026081619,0.025491314,0.025154134,0.025053258,0.024984477,0.025041579,0.025116377,
				    0.025250292,0.025434922,0.025535509,0.025563220,0.025463654,0.025365333,0.025212374,0.025091757,
				    0.025002306,0.025044858,0.025155483,0.025336148,0.025770970,0.026243687},
				   {0.025775355,0.025375476,0.025193604,0.025121461,0.025091116,0.025133500,0.025134094,0.025298875,
				    0.025347101,0.025534560,0.025637323,0.025641922,0.025455080,0.025410546,0.025281497,0.025127820,
				    0.025073886,0.025083027,0.025307404,0.025840548,0.026601374,0.027717006}};

//===============================================================================================
//parameters for Z pt correction

const float rochcor44X::ptlow[85] = {0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5,
				  6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5,
				  10.0, 10.5, 11.0, 11.5, 12.0, 12.5, 13.0, 13.5, 14.0, 14.5,
				  15.0, 15.5, 16.0, 16.5, 17.0, 17.5, 18.0, 18.5, 19.0, 19.5,
				  20.0, 20.5, 21.0, 21.5, 22.0, 22.5, 23.0, 23.5, 24.0, 24.5,
				  25.0, 26.0, 27.0, 28.0, 29.0,
				  30.0, 32.0, 34.0, 36.0, 38.0,
				  40.0, 44.0, 48.0, 52.0, 56.0,
				  60.0, 65.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0,
				  100.0, 110.0, 120.0, 130.0, 140.0, 150.0, 175.0,
				  200.0, 250.0, 350.0, 500.0, 1000.0};

//int nptbins( sizeof(ptlow)/sizeof(float) - 1 );

const float rochcor44X::zptscl[84] = {1.62964,1.53299,1.44088,1.33503,1.29242,1.13319,1.1201,1.10811,0.992511,0.956751,
				   0.935383,0.909322,0.90837,0.901406,0.883813,0.931082,0.898036,0.872295,0.925305,
				   0.963303,0.933956,0.915774,0.910455,0.956979,0.945336,0.969349,0.940201,0.955804,
				   0.950218,1.01371,0.97556,0.991332,0.939041,0.940316,0.976578,0.99464,0.974005,
				   1.0072,1.03932,0.969313,0.960051,1.01457,0.988141,0.994937,0.968738,0.984177,
				   1.03109,1.0367,0.912254,1.04971,0.970031,1.01293,1.00382,0.988483,0.976409,1.01115,
				   0.985687,0.989351,1.01611,1.00756,0.992071,1.01483,1.01444,1.03297,1.08866,1.10325,
				   1.06604,1.06214,1.12942,1.10811,1.11041,1.13956,1.16584,1.09633,1.24445,1.16436,
				   1.19486,1.19513,1.22895,1.18531,1.18177,1.12256,1.1672,1.87976};


const float rochcor44X::zptscler[84] = {0.0294984,0.0162434,0.0121944,0.0099485,0.0088135,0.00743117,0.00705711,0.00684279,
				     0.00616736,0.00596599,0.00589138,0.00579651,0.0058861,0.00596648,0.00598243,0.00636023,
				     0.00632113,0.00630161,0.00679044,0.00719776,0.00715072,0.00721491,0.00736719,0.00786873,
				     0.00796668,0.00834301,0.00831559,0.00860647,0.00874932,0.00946821,0.00937378,0.00971243,
				     0.00947482,0.00972364,0.0102102,0.0105725,0.0105773,0.0111158,0.0116094,0.0112022,0.0113484,
				     0.0120954,0.0120832,0.0124166,0.0123159,0.0127669,0.0134762,0.013815,0.012577,0.0145407,
				     0.00988852,0.0106237,0.0108213,0.0111293,0.0114568,0.00869239,0.00908969,0.00959648,0.0104104,
				     0.0109857,0.00823061,0.00927262,0.0101741,0.011348,0.0128945,0.012886,0.0140573,0.0155477,
				     0.0178927,0.0198073,0.0216724,0.0243028,0.0271627,0.0208322,0.0268699,0.0300166,0.0359204,
				     0.0418172,0.0334502,0.0452334,0.0489154,0.0651387,0.159474,0.528352};

rochcor44X::~rochcor44X(){
}

rochcor44X::rochcor44X(){
  
  eran.SetSeed(123456);
  sran.SetSeed(1234);
  
}

void rochcor44X::momcor_mc( TLorentzVector& mu, float charge, float sysdev){
  
  //sysdev == num : deviation = num

  float ptmu = mu.Pt();
  float muphi = mu.Phi();
  float mueta = mu.Eta(); // same with mu.Eta() in Root

  float px = mu.Px();
  float py = mu.Py();
  float pz = mu.Pz();
  float e = mu.E();

  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);

  float mptsys = sran.Gaus(0.0,sysdev);
  
  float dm = (mcor_bfA[mu_phibin][mu_etabin] + mptsys*mcor_bfAer[mu_phibin][mu_etabin])/mmavgA[mu_phibin][mu_etabin];
  float da = mcor_maA[mu_phibin][mu_etabin] + mptsys*mcor_maAer[mu_phibin][mu_etabin];

  float cor = 1.0/(1.0 + dm + charge*da*ptmu);

  //for the momentum tuning - eta,phi,Q correction
  px *= cor;
  py *= cor;
  pz *= cor;
  e *= cor;
  
  float recm = recmA;
  //float drecm = drecmA;
  
  float gscler = TMath::Sqrt( TMath::Power(mgsclA_stat,2) + TMath::Power(mgsclA_syst,2) );
  
  float gscl = (genm_smr/recm);
  
  px *= (gscl + sysdev*gscler);
  py *= (gscl + sysdev*gscler);
  pz *= (gscl + sysdev*gscler);
  e *= (gscl + sysdev*gscler);
  
  mu.SetPxPyPzE(px,py,pz,e);
  
}


void rochcor44X::momcor_data( TLorentzVector& mu, float charge, float sysdev){
    
  float ptmu = mu.Pt();

  float muphi = mu.Phi();
  float mueta = mu.Eta(); // same with mu.Eta() in Root

  float px = mu.Px();
  float py = mu.Py();
  float pz = mu.Pz();
  float e = mu.E();
  
  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  
  float mptsys1 = sran.Gaus(0.0,sysdev);
  
  float dm = (dcor_bfA[mu_phibin][mu_etabin] + mptsys1*dcor_bfAer[mu_phibin][mu_etabin])/dmavgA[mu_phibin][mu_etabin];
  float da = dcor_maA[mu_phibin][mu_etabin] + mptsys1*dcor_maAer[mu_phibin][mu_etabin];

  float cor = 1.0/(1.0 + dm + charge*da*ptmu);
  
  px *= cor;
  py *= cor;
  pz *= cor;
  e *= cor;
  
  //after Z pt correction
  
  float recm = drecmA;
  float gscler = TMath::Sqrt( TMath::Power(dgsclA_stat,2) + TMath::Power(dgsclA_syst,2) );
  
  float gscl = (genm_smr/recm);
  
  px *= (gscl + sysdev*gscler);
  py *= (gscl + sysdev*gscler);
  pz *= (gscl + sysdev*gscler);
  e *= (gscl + sysdev*gscler);
  
  mu.SetPxPyPzE(px,py,pz,e);
  
}

void rochcor44X::musclefit_data( TLorentzVector& mu, TLorentzVector& mubar){

  float dpar1 = 0.0;
  float dpar2 = 0.0;
  float epar1 = 0.0;
  float epar2 = 0.0;
  
  if(fabs(mu.PseudoRapidity())<=0.9){
    dpar1 = d0par;
    epar1 = e0par;
  }else if(mu.PseudoRapidity()>0.9){
    dpar1 = d1par;
    epar1 = e1par;
  }else if(mu.PseudoRapidity()<-0.9){
    dpar1 = d2par;
    epar1 = e2par;
  }

  if(fabs(mubar.PseudoRapidity())<=0.9){
    dpar2 = d0par;
    epar2 = e0par;
  }else if(mubar.PseudoRapidity()>0.9){
    dpar2 = d1par;
    epar2 = e1par;
  }else if(mubar.PseudoRapidity()<-0.9){
    dpar2 = d2par;
    epar2 = e2par;
  }

  float corr1 = 1.0 + bpar*mu.Pt() + (-1.0)*cpar*mu.Pt()*TMath::Sign(float(1.0),float(mu.PseudoRapidity()))*TMath::Power(mu.PseudoRapidity(),2)
    + (-1.0)*dpar1*mu.Pt()*sin(mu.Phi() + epar1);
  float corr2 = 1.0 + bpar*mubar.Pt() + (1.0)*cpar*mubar.Pt()*TMath::Sign(float(1.0),float(mubar.PseudoRapidity()))*TMath::Power(mubar.PseudoRapidity(),2)
    + (1.0)*dpar2*mubar.Pt()*sin(mubar.Phi() + epar2);
  
  float px1 = mu.Px();
  float py1 = mu.Py();
  float pz1 = mu.Pz();
  float e1 = mu.E();
  
  float px2 = mubar.Px();
  float py2 = mubar.Py();
  float pz2 = mubar.Pz();
  float e2 = mubar.E();

  px1 *= corr1;
  py1 *= corr1;
  pz1 *= corr1;
  e1 *= corr1;
  
  px2 *= corr2;
  py2 *= corr2;
  pz2 *= corr2;
  e2 *= corr2;
  
  mu.SetPxPyPzE(px1,py1,pz1,e1);
  mubar.SetPxPyPzE(px2,py2,pz2,e2);

}

Int_t rochcor44X::phibin(float phi){
  
  int nphibin = -1;
  
  for(int i=0; i<8; i++){
    if(-pi+(2.0*pi/8.0)*i <= phi && -pi+(2.0*pi/8.0)*(i+1) > phi){
      nphibin = i;
      break;
    }
  }
  
  return nphibin;
}

Int_t rochcor44X::etabin(float eta){

  int nbin = -1;
  
  for(int i=0; i<22; i++){
    if(netabin[i] <= eta && netabin[i+1] > eta){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}

float rochcor44X::zptcor(float gzpt) {
  int ibin( 0 );
  
  // mcptscl[] = 84 bins: [0] and [83] are the underflow and overflow
  if ( gzpt > ptlow[nptbins] ) return nptbins-1;
  if ( gzpt < ptlow[0      ] ) return 0;
  
  for ( int i=0; i<nptbins; ++i ) {
    if ( gzpt>=ptlow[i] && gzpt<ptlow[i+1] ) { ibin=i; break; }
  }

  float zptwt = zptscl[ibin];

  return zptwt;
}
