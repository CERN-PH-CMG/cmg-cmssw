#include <rochcor_44X_v2.h>
#include <TLorentzVector.h>


const float rochcor44X::netabin[23]={-2.4,-2.1,-1.85,-1.6,-1.4,-1.2,-1.0,-0.8,-0.6,-0.4,-0.2,
				  0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.4};


const float rochcor44X::dcor_bfA[8][22]={{-0.000058594,-0.000041262,-0.000017179,-0.000074133,-0.000047642,-0.000044754,-0.000021183,
				       -0.000042484,-0.000037271,-0.000090814,-0.000084065,-0.000029321,0.000002258,-0.000041510,
				       -0.000042807,-0.000007038,-0.000041120,-0.000056145,-0.000085131,-0.000062614,-0.000122450,-0.000065314},
				      {0.000016311,-0.000033745,-0.000000149,0.000028490,-0.000002136,-0.000020830,-0.000020069,
				       -0.000041284,-0.000054916,-0.000006234,-0.000040342,-0.000044306,-0.000044444,-0.000040458,
				       -0.000051813,-0.000038257,-0.000039921,-0.000024807,-0.000043160,-0.000064375,-0.000039557,0.000002480},
				      {-0.000010441,0.000007000,-0.000037702,-0.000000907,-0.000012812,-0.000006561,-0.000012327,
				       -0.000059378,-0.000051701,0.000029656,-0.000055473,-0.000034052,-0.000057370,-0.000042691,
				       -0.000022828,-0.000045698,-0.000043805,-0.000040240,-0.000038690,0.000006530,-0.000023933,-0.000019576},
				      {-0.000092766,-0.000056918,-0.000041084,-0.000056738,-0.000042959,-0.000045428,-0.000021343,
				       -0.000058879,-0.000009759,-0.000091568,-0.000093498,-0.000047149,-0.000093533,-0.000054885,
				       -0.000013814,-0.000048044,-0.000049086,-0.000071330,-0.000071909,-0.000044398,-0.000058942,-0.000042627},
				      {-0.000082822,-0.000070394,-0.000058003,-0.000015632,-0.000016558,-0.000036721,-0.000034457,
				       -0.000045380,-0.000022960,-0.000027920,-0.000064529,-0.000051274,-0.000023434,-0.000063937,
				       -0.000046826,-0.000028926,-0.000049833,-0.000065085,-0.000069999,-0.000027202,-0.000137680,0.000017663},
				      {-0.000091841,-0.000153194,-0.000108258,-0.000089586,-0.000091191,-0.000051013,-0.000089036,
				       -0.000070638,-0.000045713,-0.000031334,-0.000079999,-0.000034102,-0.000029192,-0.000068072,
				       -0.000063505,-0.000028253,-0.000076523,-0.000035582,-0.000116691,-0.000086046,-0.000085647,-0.000074124},
				      {-0.000167852,-0.000131789,-0.000107034,-0.000086896,-0.000049638,-0.000028288,-0.000090423,
				       -0.000060726,-0.000061394,-0.000043335,-0.000044079,-0.000036015,-0.000050310,-0.000082949,
				       -0.000021658,-0.000068248,-0.000010053,-0.000052022,-0.000085227,-0.000051253,-0.000101411,-0.000043988},
				      {-0.000103883,-0.000142263,-0.000094933,-0.000060685,-0.000053004,-0.000015229,-0.000026588,
				       -0.000029924,-0.000034112,-0.000050182,-0.000031727,-0.000039455,-0.000055713,-0.000040381,
				       -0.000035587,-0.000030762,-0.000028432,-0.000056109,-0.000089699,-0.000052129,-0.000043276,0.000004684}};

const float rochcor44X::dcor_maA[8][22]={{0.000367251,0.000121190,0.000051593,-0.000005718,-0.000033921,-0.000061696,-0.000069428,-0.000059705,
				       -0.000060170,-0.000120429,-0.000103409,-0.000098392,-0.000133546,-0.000100096,-0.000107267,-0.000101997,
				       -0.000145560,-0.000099527,-0.000021944,0.000137497,0.000435323,0.000714679},
				      {0.000927791,0.000383738,0.000139331,0.000064836,-0.000014732,0.000005699,0.000002382,0.000005336,
				       -0.000015506,-0.000023333,-0.000009199,-0.000051130,-0.000031891,-0.000008196,-0.000023243,0.000003954,
				       -0.000034608,0.000017635,0.000010795,-0.000025346,-0.000076370,-0.000027438},
				      {-0.000047426,-0.000002204,0.000026339,0.000061128,0.000035854,0.000093816,0.000083671,0.000100311,
				       0.000146818,0.000114857,0.000090984,0.000098458,0.000057049,0.000057489,0.000079156,-0.000020165,
				       0.000035782,0.000000948,0.000004095,-0.000054271,-0.000186939,-0.000210239},
				      {-0.001111183,-0.000459256,-0.000105708,0.000115289,0.000107075,0.000153744,0.000202329,0.000196114,
				       0.000151601,0.000179089,0.000206798,0.000110046,0.000098169,0.000108485,0.000130233,0.000094385,
				       0.000092311,0.000031637,0.000009780,-0.000077393,-0.000061322,-0.000224418},
				      {-0.000955681,-0.000417778,-0.000026835,0.000156181,0.000177384,0.000175746,0.000121085,0.000131028,
				       0.000120731,0.000139963,0.000128775,0.000134769,0.000145764,0.000111158,0.000095950,0.000112319,
				       0.000102117,0.000142312,0.000139195,0.000067627,-0.000010600,-0.000300878},
				      {-0.000353392,-0.000167438,-0.000023178,0.000052902,0.000042836,0.000008857,-0.000007339,-0.000017520,
				       0.000021778,0.000018368,-0.000012200,0.000033059,0.000020868,0.000013139,-0.000030949,0.000020943,
				       0.000035121,0.000068807,0.000083326,0.000117793,0.000116182,-0.000216710},
				      {0.000243348,0.000072927,-0.000027764,-0.000053308,-0.000107495,-0.000088170,-0.000065203,-0.000075354,
				       -0.000088303,-0.000128322,-0.000124412,-0.000117895,-0.000122703,-0.000153883,-0.000129236,-0.000128779,
				       -0.000149065,-0.000171104,-0.000171909,-0.000105680,0.000008474,0.000535906},
				      {0.000168619,0.000108170,0.000037168,-0.000004794,-0.000078812,-0.000050683,-0.000077355,-0.000139484,
				       -0.000146415,-0.000129958,-0.000166489,-0.000155687,-0.000207765,-0.000175506,-0.000216001,-0.000236853,
				       -0.000263564,-0.000248424,-0.000221999,-0.000080669,0.000243920,0.000877884}};

const float rochcor44X::dcor_bfAer[8][22]={{0.000079256,0.000072222,0.000069696,0.000070040,0.000066152,0.000064809,0.000064043,0.000060193,
					 0.000059849,0.000060819,0.000060219,0.000059932,0.000060747,0.000062099,0.000060149,0.000064082,
					 0.000065696,0.000067162,0.000071144,0.000070079,0.000073067,0.000077305},
					{0.000073880,0.000071734,0.000066546,0.000069656,0.000068182,0.000065193,0.000062671,0.000060330,
					 0.000060707,0.000061473,0.000059328,0.000059911,0.000061463,0.000059015,0.000061308,0.000062724,
					 0.000066037,0.000068964,0.000071489,0.000067234,0.000071690,0.000073337},
					{0.000076308,0.000073904,0.000070022,0.000071004,0.000068000,0.000065632,0.000063255,0.000060432,
					 0.000059316,0.000060891,0.000060008,0.000060058,0.000060480,0.000059357,0.000060038,0.000063012,
					 0.000064374,0.000068438,0.000070951,0.000068250,0.000071002,0.000073924},
					{0.000073947,0.000073361,0.000069879,0.000069294,0.000066813,0.000063922,0.000062345,0.000060303,
					 0.000060061,0.000061160,0.000061118,0.000061105,0.000061534,0.000059563,0.000060031,0.000063504,
					 0.000064451,0.000067178,0.000070907,0.000066858,0.000071033,0.000072888},
					{0.000075850,0.000073368,0.000069058,0.000070426,0.000067332,0.000065720,0.000064566,0.000060224,
					 0.000059404,0.000060840,0.000060604,0.000060431,0.000060435,0.000059379,0.000060244,0.000062862,
					 0.000066446,0.000068876,0.000070065,0.000071236,0.000073712,0.000079979},
					{0.000073369,0.000071079,0.000066955,0.000069492,0.000066571,0.000065067,0.000062768,0.000059504,
					 0.000060088,0.000067632,0.000059502,0.000060273,0.000065760,0.000059531,0.000059648,0.000062024,
					 0.000065080,0.000066327,0.000069943,0.000069444,0.000071486,0.000073024},
					{0.000075689,0.000074063,0.000068883,0.000069376,0.000067230,0.000063105,0.000064101,0.000061272,
					 0.000059007,0.000061185,0.000060243,0.000058584,0.000066989,0.000059155,0.000060586,0.000062948,
					 0.000064088,0.000066882,0.000070070,0.000066941,0.000072849,0.000073662},
					{0.000074757,0.000072976,0.000069909,0.000070126,0.000066062,0.000064889,0.000063308,0.000060297,
					 0.000060201,0.000060824,0.000059824,0.000060300,0.000060694,0.000060088,0.000061023,0.000062422,
					 0.000063242,0.000068576,0.000073830,0.000066846,0.000071689,0.000073005}};

const float rochcor44X::dcor_maAer[8][22]={{0.000079256,0.000072222,0.000069696,0.000070040,0.000066152,0.000064809,0.000064043,0.000060193,
					 0.000059849,0.000060819,0.000060219,0.000059932,0.000060747,0.000062099,0.000060149,0.000064082,
					 0.000065696,0.000067162,0.000071144,0.000070079,0.000073067,0.000077305},
					{0.000073880,0.000071734,0.000066546,0.000069656,0.000068182,0.000065193,0.000062671,0.000060330,
					 0.000060707,0.000061473,0.000059328,0.000059911,0.000061463,0.000059015,0.000061308,0.000062724,
					 0.000066037,0.000068964,0.000071489,0.000067234,0.000071690,0.000073337},
					{0.000076308,0.000073904,0.000070022,0.000071004,0.000068000,0.000065632,0.000063255,0.000060432,
					 0.000059316,0.000060891,0.000060008,0.000060058,0.000060480,0.000059357,0.000060038,0.000063012,
					 0.000064374,0.000068438,0.000070951,0.000068250,0.000071002,0.000073924},
					{0.000073947,0.000073361,0.000069879,0.000069294,0.000066813,0.000063922,0.000062345,0.000060303,
					 0.000060061,0.000061160,0.000061118,0.000061105,0.000061534,0.000059563,0.000060031,0.000063504,
					 0.000064451,0.000067178,0.000070907,0.000066858,0.000071033,0.000072888},
					{0.000075850,0.000073368,0.000069058,0.000070426,0.000067332,0.000065720,0.000064566,0.000060224,
					 0.000059404,0.000060840,0.000060604,0.000060431,0.000060435,0.000059379,0.000060244,0.000062862,
					 0.000066446,0.000068876,0.000070065,0.000071236,0.000073712,0.000079979},
					{0.000073369,0.000071079,0.000066955,0.000069492,0.000066571,0.000065067,0.000062768,0.000059504,
					 0.000060088,0.000067632,0.000059502,0.000060273,0.000065760,0.000059531,0.000059648,0.000062024,
					 0.000065080,0.000066327,0.000069943,0.000069444,0.000071486,0.000073024},
					{0.000075689,0.000074063,0.000068883,0.000069376,0.000067230,0.000063105,0.000064101,0.000061272,
					 0.000059007,0.000061185,0.000060243,0.000058584,0.000066989,0.000059155,0.000060586,0.000062948,
					 0.000064088,0.000066882,0.000070070,0.000066941,0.000072849,0.000073662},
					{0.000074757,0.000072976,0.000069909,0.000070126,0.000066062,0.000064889,0.000063308,0.000060297,
					 0.000060201,0.000060824,0.000059824,0.000060300,0.000060694,0.000060088,0.000061023,0.000062422,
					 0.000063242,0.000068576,0.000073830,0.000066846,0.000071689,0.000073005}};

const float rochcor44X::mcor_bfA[8][22]={{-0.000095015,-0.000059324,-0.000061253,-0.000047266,-0.000034649,-0.000004335,0.000007208,0.000017518,
				       0.000010986,0.000010698,0.000017242,0.000014136,0.000017400,0.000001934,-0.000001162,0.000009468,
				       0.000006080,-0.000014981,-0.000036441,-0.000110940,-0.000104751,-0.000110439},
				      {-0.000092230,-0.000035311,-0.000041109,-0.000016964,0.000009014,-0.000009019,0.000012469,-0.000018006,
				       0.000000211,-0.000006735,-0.000019615,-0.000029834,-0.000021373,-0.000018165,-0.000011851,-0.000020296,
				       -0.000017469,-0.000001810,-0.000008802,-0.000044460,0.000005908,-0.000034302},
				      {-0.000066451,-0.000057013,-0.000035271,-0.000058952,0.000007577,-0.000009868,0.000012983,-0.000007814,
				       -0.000008392,-0.000003066,-0.000012718,-0.000029721,-0.000003062,-0.000018970,-0.000032295,-0.000017224,
				       -0.000030757,-0.000009456,0.000004038,-0.000042422,-0.000030001,-0.000066157},
				      {-0.000090240,-0.000058767,-0.000083085,-0.000017275,-0.000007844,0.000021927,0.000015830,-0.000001084,
				       0.000011140,-0.000000449,-0.000015245,-0.000006139,-0.000035870,-0.000010824,-0.000009723,-0.000008288,
				       -0.000016633,-0.000002737,0.000004726,-0.000040777,-0.000024072,-0.000069701},
				      {-0.000054301,-0.000059425,-0.000039202,-0.000040546,-0.000021351,0.000015438,-0.000004569,0.000014461,
				       0.000013993,0.000046454,0.000011023,0.000020247,-0.000001235,0.000002469,0.000002510,-0.000025599,
				       -0.000017132,-0.000011634,-0.000033927,-0.000020507,-0.000032250,-0.000066380},
				      {-0.000055168,-0.000076743,-0.000042344,-0.000050236,-0.000028095,0.000019557,0.000017153,0.000026138,
				       0.000012445,-0.000002252,0.000030276,0.000010325,0.000014154,0.000015199,0.000014197,-0.000010192,
				       -0.000012681,-0.000031718,-0.000022660,-0.000053877,-0.000036790,-0.000068311},
				      {-0.000098519,-0.000087382,-0.000051711,-0.000058936,-0.000037919,0.000009546,0.000023272,0.000021967,
				       0.000025510,0.000027425,0.000028341,0.000024486,0.000011373,-0.000000392,0.000012281,-0.000011570,
				       0.000009166,-0.000023468,-0.000038245,-0.000053711,-0.000066990,-0.000063015},
				      {-0.000081409,-0.000048507,-0.000031980,-0.000034654,-0.000011981,-0.000011095,-0.000002821,0.000003668,
				       0.000002347,-0.000008092,-0.000000036,-0.000002294,0.000002192,-0.000001844,-0.000014988,0.000011214,
				       0.000001308,0.000008018,-0.000011854,-0.000042731,-0.000063482,-0.000053206}};

const float rochcor44X::mcor_maA[8][22]={{0.000909378,0.000425238,0.000046398,-0.000111365,-0.000184322,-0.000182817,-0.000161746,-0.000181015,
				       -0.000174259,-0.000187242,-0.000184312,-0.000182077,-0.000176220,-0.000171901,-0.000155990,-0.000173103,
				       -0.000203537,-0.000257573,-0.000168895,0.000096664,0.000139675,0.000137336},
				      {0.000996660,0.000187950,-0.000035214,-0.000133793,-0.000134924,-0.000116610,-0.000098759,-0.000097107,
				       -0.000109585,-0.000098555,-0.000108855,-0.000106162,-0.000091140,-0.000096629,-0.000067699,-0.000058922,
				       -0.000050117,-0.000051818,-0.000036461,0.000170270,0.000470134,0.000762076},
				      {0.000489905,-0.000039973,-0.000060163,-0.000010517,0.000017620,0.000017938,0.000015343,0.000023979,
				       0.000026113,0.000045886,0.000020717,0.000041379,0.000017144,0.000011983,0.000016644,0.000031993,
				       0.000091940,0.000098843,0.000095202,0.000047730,0.000079834,0.000011879},
				      {0.000668006,0.000586028,0.000332101,0.000290601,0.000246297,0.000160021,0.000144444,0.000138831,
				       0.000137724,0.000134849,0.000139228,0.000138207,0.000167319,0.000156300,0.000146982,0.000138278,
				       0.000173809,0.000209088,0.000269774,0.000323524,0.000403011,0.000350793},
				      {0.000822953,0.000635498,0.000501614,0.000319642,0.000235396,0.000221958,0.000164087,0.000158693,
				       0.000157817,0.000151903,0.000165847,0.000160607,0.000165246,0.000169406,0.000171536,0.000173033,
				       0.000142577,0.000152798,0.000201599,0.000331309,0.000462375,0.000961296},
				      {-0.001143524,-0.000400351,-0.000089347,0.000037043,0.000099839,0.000109525,0.000112013,0.000113644,
				       0.000107552,0.000112347,0.000100852,0.000111103,0.000102876,0.000102980,0.000108551,0.000097883,
				       0.000063729,0.000028798,0.000052058,0.000148525,0.000228482,0.000772006},
				      {-0.001663725,-0.000601815,-0.000273952,-0.000048322,-0.000022511,-0.000029220,-0.000022061,-0.000031681,
				       -0.000008492,-0.000017742,-0.000018192,-0.000015683,-0.000035508,-0.000018215,-0.000033187,-0.000024933,
				       -0.000058487,-0.000066712,-0.000055129,-0.000118582,-0.000230073,-0.000238211},
				      {0.000388920,0.000263810,0.000103887,-0.000060728,-0.000136532,-0.000156763,-0.000134982,-0.000143657,
				       -0.000123940,-0.000123376,-0.000119346,-0.000117452,-0.000121735,-0.000130469,-0.000130102,-0.000145210,
				       -0.000162300,-0.000133222,-0.000314112,-0.000759003,-0.001257953,-0.002104845}};

const float rochcor44X::mcor_bfAer[8][22]={{0.000034723,0.000031883,0.000029990,0.000031194,0.000029402,0.000027985,0.000026897,0.000026119,0.000025806,
					 0.000025973,0.000025645,0.000025835,0.000026082,0.000026039,0.000026305,0.000027487,0.000028388,0.000029829,
					 0.000031353,0.000031368,0.000032169,0.000033443},
					{0.000032579,0.000031469,0.000029829,0.000030966,0.000029455,0.000028607,0.000027382,0.000026449,0.000026116,
					 0.000026781,0.000025933,0.000026023,0.000026499,0.000026128,0.000026490,0.000027540,0.000028584,0.000029376,
					 0.000030858,0.000030479,0.000031451,0.000032379},
					{0.000032578,0.000031539,0.000030768,0.000030827,0.000029180,0.000028368,0.000027210,0.000026227,0.000025964,
					 0.000026641,0.000025997,0.000025766,0.000026791,0.000025913,0.000026323,0.000027440,0.000028577,0.000029424,
					 0.000031249,0.000029822,0.000031298,0.000032191},
					{0.000032754,0.000031578,0.000031219,0.000030746,0.000029057,0.000028058,0.000027028,0.000026035,0.000025914,
					 0.000026110,0.000025815,0.000025719,0.000026056,0.000025826,0.000026014,0.000027065,0.000027924,0.000028907,
					 0.000031071,0.000029306,0.000031255,0.000032233},
					{0.000032824,0.000031895,0.000030023,0.000031240,0.000029376,0.000028171,0.000027170,0.000026029,0.000025886,
					 0.000026204,0.000025693,0.000025810,0.000026099,0.000025706,0.000026292,0.000027141,0.000028774,0.000029186,
					 0.000030626,0.000032556,0.000032152,0.000035553},
					{0.000032461,0.000031586,0.000029987,0.000031133,0.000029257,0.000028343,0.000027253,0.000026195,0.000025852,
					 0.000028431,0.000025776,0.000025948,0.000027629,0.000025929,0.000026316,0.000027385,0.000028396,0.000029173,
					 0.000030787,0.000029904,0.000031594,0.000032337},
					{0.000032728,0.000031634,0.000030124,0.000030843,0.000029117,0.000028332,0.000027293,0.000026183,0.000025919,
					 0.000026332,0.000025967,0.000025949,0.000027398,0.000026014,0.000026265,0.000027186,0.000028222,0.000029173,
					 0.000030709,0.000029306,0.000031418,0.000032315},
					{0.000032694,0.000031657,0.000031245,0.000030807,0.000029275,0.000028079,0.000027186,0.000026021,0.000025930,
					 0.000025952,0.000025685,0.000025748,0.000026008,0.000025822,0.000026129,0.000026884,0.000028057,0.000029492,
					 0.000031599,0.000029380,0.000031082,0.000032497}};

const float rochcor44X::mcor_maAer[8][22]={{0.000034723,0.000031883,0.000029990,0.000031194,0.000029402,0.000027985,0.000026897,0.000026119,0.000025806,
					 0.000025973,0.000025645,0.000025835,0.000026082,0.000026039,0.000026305,0.000027487,0.000028388,0.000029829,
					 0.000031353,0.000031368,0.000032169,0.000033443},
					{0.000032579,0.000031469,0.000029829,0.000030966,0.000029455,0.000028607,0.000027382,0.000026449,0.000026116,
					 0.000026781,0.000025933,0.000026023,0.000026499,0.000026128,0.000026490,0.000027540,0.000028584,0.000029376,
					 0.000030858,0.000030479,0.000031451,0.000032379},
					{0.000032578,0.000031539,0.000030768,0.000030827,0.000029180,0.000028368,0.000027210,0.000026227,0.000025964,
					 0.000026641,0.000025997,0.000025766,0.000026791,0.000025913,0.000026323,0.000027440,0.000028577,0.000029424,
					 0.000031249,0.000029822,0.000031298,0.000032191},
					{0.000032754,0.000031578,0.000031219,0.000030746,0.000029057,0.000028058,0.000027028,0.000026035,0.000025914,
					 0.000026110,0.000025815,0.000025719,0.000026056,0.000025826,0.000026014,0.000027065,0.000027924,0.000028907,
					 0.000031071,0.000029306,0.000031255,0.000032233},
					{0.000032824,0.000031895,0.000030023,0.000031240,0.000029376,0.000028171,0.000027170,0.000026029,0.000025886,
					 0.000026204,0.000025693,0.000025810,0.000026099,0.000025706,0.000026292,0.000027141,0.000028774,0.000029186,
					 0.000030626,0.000032556,0.000032152,0.000035553},
					{0.000032461,0.000031586,0.000029987,0.000031133,0.000029257,0.000028343,0.000027253,0.000026195,0.000025852,
					 0.000028431,0.000025776,0.000025948,0.000027629,0.000025929,0.000026316,0.000027385,0.000028396,0.000029173,
					 0.000030787,0.000029904,0.000031594,0.000032337},
					{0.000032728,0.000031634,0.000030124,0.000030843,0.000029117,0.000028332,0.000027293,0.000026183,0.000025919,
					 0.000026332,0.000025967,0.000025949,0.000027398,0.000026014,0.000026265,0.000027186,0.000028222,0.000029173,
					 0.000030709,0.000029306,0.000031418,0.000032315},
					{0.000032694,0.000031657,0.000031245,0.000030807,0.000029275,0.000028079,0.000027186,0.000026021,0.000025930,
					 0.000025952,0.000025685,0.000025748,0.000026008,0.000025822,0.000026129,0.000026884,0.000028057,0.000029492,
					 0.000031599,0.000029380,0.000031082,0.000032497}};


//==========================================================================================================================
const float rochcor44X::dmavgA[8][22]={{0.025984230,0.025082146,0.024966256,0.024824430,0.024728446,0.024862475,0.024842359,0.025309334,0.025389278,
				     0.025411175,0.025826596,0.025549764,0.025278847,0.025448078,0.025091331,0.024678706,0.024483819,0.024957042,
				     0.025283342,0.025028835,0.025839816,0.026639789},
				    {0.026123536,0.025600672,0.024920231,0.024664096,0.024953169,0.024944622,0.024998903,0.025293980,0.025506900,
				     0.025365410,0.025523744,0.025684038,0.025438035,0.025270635,0.025230973,0.025109848,0.024939392,0.024858305,
				     0.025073080,0.025008546,0.025292406,0.025461660},
				    {0.025726865,0.025244756,0.025476528,0.025093169,0.025128587,0.024878809,0.025014454,0.025396789,0.025499509,
				     0.025463706,0.025784430,0.025549879,0.025661084,0.025410821,0.025351179,0.025144981,0.025278551,0.025167638,
				     0.024858652,0.025207945,0.025091062,0.025265266},
				    {0.025320828,0.025289931,0.025013484,0.025015790,0.025020849,0.024786689,0.025259154,0.025312728,0.025211959,
				     0.025638434,0.026007918,0.025892978,0.025601889,0.025580290,0.025115028,0.025166792,0.025046125,0.025148530,
				     0.024922769,0.024955273,0.025409958,0.025728994},
				    {0.025112449,0.024786356,0.024980236,0.024902899,0.025094321,0.025288037,0.025088723,0.025382989,0.025041409,
				     0.025437424,0.025730364,0.025849738,0.025240436,0.025682627,0.025173059,0.025428365,0.025240621,0.025143192,
				     0.025023909,0.024974894,0.025408600,0.025469002},
				    {0.025470659,0.025140019,0.024973000,0.024968528,0.025169717,0.024827853,0.025033190,0.025276414,0.025226149,
				     0.025638189,0.025720453,0.025798915,0.025284300,0.025417884,0.025122676,0.024798016,0.025126997,0.024786156,
				     0.025224520,0.025206599,0.025379926,0.025567150},
				    {0.026145224,0.025060486,0.024964108,0.025292277,0.024723962,0.024922786,0.025428914,0.025196765,0.025108393,
				     0.025200400,0.025721535,0.025290527,0.025300107,0.025244939,0.024804966,0.024873783,0.024891052,0.024657773,
				     0.024890698,0.025036460,0.025469938,0.026282316},
				    {0.026179348,0.025356090,0.025458181,0.024833607,0.024912670,0.025071111,0.024905044,0.024761980,0.025163494,
				     0.025538026,0.025543288,0.025638214,0.025361847,0.025334154,0.024874820,0.024877670,0.024738300,0.024898959,
				     0.025102404,0.024940504,0.025317674,0.026207040}};

const float rochcor44X::dpavgA[8][22]={{0.025599458,0.025303374,0.024628068,0.025450270,0.024639463,0.024954197,0.024951906,0.025250622,0.025480131,
				     0.025588816,0.026069284,0.025336619,0.025494567,0.025420431,0.024933758,0.025074288,0.024951250,0.025035629,
				     0.025277123,0.025030328,0.025091994,0.025500469},
				    {0.024738722,0.024869361,0.024780908,0.024366327,0.024573523,0.025240096,0.024789142,0.025093727,0.025520403,
				     0.025700419,0.025741929,0.025498069,0.025778900,0.025631495,0.025482906,0.025178172,0.025205611,0.024200904,
				     0.024618052,0.025110465,0.025496297,0.025545287},
				    {0.025890878,0.025027081,0.025185328,0.024712106,0.024995666,0.024501322,0.025075570,0.025079335,0.024957659,
				     0.025597617,0.025699174,0.025489590,0.025467521,0.025586812,0.025051912,0.025256485,0.025192831,0.024703559,
				     0.025075043,0.024799180,0.025510491,0.025747545},
				    {0.026849794,0.026090751,0.025407281,0.024880322,0.024549205,0.024909064,0.024667567,0.024903414,0.025290311,
				     0.025858997,0.025405334,0.025670355,0.025503716,0.025373631,0.025055978,0.025108400,0.024823013,0.024882971,
				     0.025107208,0.025310388,0.025402033,0.025825828},
				    {0.026594747,0.025718475,0.025010893,0.024968248,0.024531996,0.024627992,0.024759194,0.024977530,0.025172186,
				     0.025567629,0.025675174,0.025544158,0.025143104,0.025462744,0.025030712,0.024939483,0.024763541,0.025041814,
				     0.024974078,0.024984683,0.025782346,0.025698714},
				    {0.026210979,0.025675139,0.025285335,0.024900580,0.024832817,0.024997865,0.025521072,0.024737600,0.025628843,
				     0.025232847,0.025800249,0.025413916,0.025421980,0.025378656,0.025644619,0.024898481,0.025180089,0.024802423,
				     0.025149020,0.025242644,0.025100808,0.025754566},
				    {0.025877266,0.025411625,0.025327227,0.025047540,0.024915831,0.025158682,0.025481483,0.025231312,0.025442977,
				     0.025755358,0.025546671,0.025586802,0.025524293,0.025707273,0.025088233,0.025074598,0.024879833,0.025044244,
				     0.025582250,0.025271114,0.025840350,0.025568572},
				    {0.025822380,0.025519482,0.025048940,0.024934625,0.024780401,0.024743224,0.024879378,0.024984828,0.025702469,
				     0.025875821,0.025473625,0.025751331,0.025891097,0.025602971,0.025600186,0.024973571,0.025441976,0.025205004,
				     0.025619494,0.025049296,0.025264661,0.025041281}};

const float rochcor44X::mmavgA[8][22]={{0.026699415,0.025889833,0.025287431,0.024965949,0.024879296,0.024859272,0.024869741,0.024909760,0.025083741,
				     0.025192140,0.025289613,0.025332425,0.025174369,0.025066909,0.024993659,0.024861264,0.024792818,0.024871988,
				     0.024948913,0.025452639,0.025716985,0.026180003},
				    {0.026782481,0.025541371,0.025155427,0.024821520,0.024857688,0.024905976,0.024874044,0.025143502,0.025200477,
				     0.025421876,0.025523614,0.025515983,0.025447495,0.025196471,0.025144296,0.025035573,0.024936724,0.024899409,
				     0.024900069,0.025393168,0.025784231,0.026517441},
				    {0.026337876,0.025429402,0.025158726,0.025069263,0.024945768,0.024943112,0.025047834,0.025229107,0.025391152,
				     0.025560502,0.025575496,0.025659346,0.025460015,0.025340678,0.025238377,0.025118506,0.025119286,0.025014086,
				     0.025040949,0.025210676,0.025431746,0.025873304},
				    {0.026466979,0.026011565,0.025575826,0.025300336,0.025207431,0.025084764,0.025123546,0.025242252,0.025374240,
				     0.025512113,0.025678149,0.025605514,0.025610538,0.025467321,0.025257730,0.025108866,0.025087917,0.025051114,
				     0.025198241,0.025471713,0.025786795,0.026192340},
				    {0.026599660,0.026039831,0.025647338,0.025351727,0.025268429,0.025111903,0.025146497,0.025184534,0.025339350,
				     0.025284291,0.025593505,0.025597522,0.025573607,0.025480977,0.025293132,0.025178957,0.025139834,0.025155862,
				     0.025221670,0.025439891,0.025818165,0.026749790},
				    {0.024900469,0.025122648,0.025171560,0.025112287,0.025114075,0.024968022,0.025114926,0.025167395,0.025303494,
				     0.025574601,0.025481253,0.025600149,0.025467780,0.025343016,0.025221526,0.025160477,0.025032615,0.025082882,
				     0.025046956,0.025379596,0.025667677,0.026565169},
				    {0.024656318,0.025081065,0.024948821,0.025096108,0.025004528,0.024910333,0.024975983,0.025099396,0.025188981,
				     0.025329863,0.025433604,0.025496861,0.025370620,0.025250526,0.025059307,0.025063811,0.024880672,0.024941244,
				     0.024996084,0.025129381,0.025260223,0.025709294},
				    {0.026309719,0.025698551,0.025287742,0.025065925,0.024867027,0.024839643,0.025003386,0.025025847,0.025177623,
				     0.025351943,0.025432284,0.025446660,0.025338714,0.025147581,0.025161520,0.024958861,0.024888858,0.024928698,
				     0.024755155,0.024606036,0.024497808,0.024259016}};

const float rochcor44X::mpavgA[8][22]={{0.025300600,0.025162969,0.025205610,0.025157662,0.025190505,0.025047161,0.025175701,0.025250905,0.025342587,
				     0.025473842,0.025626184,0.025633307,0.025474633,0.025362164,0.025192568,0.025152230,0.025090863,0.025132216,
				     0.025222307,0.025314157,0.025553751,0.026030545},
				    {0.025183028,0.025306860,0.025219591,0.025157804,0.024960280,0.025030846,0.025118281,0.025274214,0.025363356,
				     0.025513776,0.025710183,0.025711726,0.025538182,0.025390756,0.025167157,0.025135134,0.024978011,0.024950088,
				     0.025063909,0.025042104,0.025071950,0.025364839},
				    {0.025669589,0.025598768,0.025322205,0.025139528,0.024941286,0.024962846,0.024982444,0.025196717,0.025314594,
				     0.025445683,0.025540815,0.025568452,0.025459875,0.025302305,0.025245725,0.025044270,0.024919603,0.024870883,
				     0.024943655,0.025194962,0.025455710,0.025974451},
				    {0.025564796,0.025047693,0.025098845,0.024817122,0.024761803,0.024825385,0.024860480,0.025052176,0.025164512,
				     0.025330716,0.025502179,0.025470279,0.025394201,0.025167488,0.025051006,0.024970757,0.024934131,0.024828609,
				     0.024838052,0.025012687,0.025196791,0.025871729},
				    {0.025484709,0.025109572,0.024843657,0.024839776,0.024755595,0.024689714,0.024843112,0.024957040,0.025080582,
				     0.025220835,0.025335286,0.025346556,0.025263915,0.025110775,0.024983068,0.024977473,0.024904034,0.024837585,
				     0.024936005,0.024929343,0.025195974,0.025282595},
				    {0.026993688,0.025911146,0.025281979,0.025142434,0.024964803,0.024896495,0.024882305,0.025048949,0.025154440,
				     0.025350783,0.025458736,0.025437317,0.025427734,0.025188946,0.025039355,0.024997777,0.024909011,0.024965127,
				     0.025019059,0.025150014,0.025377011,0.025375240},
				    {0.027518018,0.026089682,0.025498668,0.025168501,0.025086464,0.024988267,0.025017045,0.025107464,0.025237122,
				     0.025433297,0.025513682,0.025555782,0.025471546,0.025386724,0.025212145,0.025098108,0.025018050,0.025074281,
				     0.025162769,0.025321313,0.025772137,0.026201725},
				    {0.025733895,0.025322440,0.025157559,0.025097678,0.025091299,0.025143685,0.025126935,0.025332868,0.025346315,
				     0.025548455,0.025635303,0.025661522,0.025456791,0.025438265,0.025293191,0.025091653,0.025070194,0.025044649,
				     0.025282361,0.025784577,0.026583034,0.027655623}};

//===============================================================================================
//parameters for Z pt correction

const float rochcor44X::ptlow[85] = {0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5,
				  6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5,
				  10.0, 10.5, 11.0, 11.5, 12.0, 12.5, 13.0, 13.5, 14.0, 14.5,
				  15.0, 15.5, 16.0, 16.5, 17.0, 17.5, 18.0, 18.5, 19.0, 19.5,
				  20.0, 20.5, 21.0, 21.5, 22.0, 22.5, 23.0, 23.5, 24.0, 24.5,
				  25.0, 26.0, 27.0, 28.0, 29.0,
				  30.0, 32.0, 34.0, 36.0, 38.0,
				  40.0, 44.0, 48.0, 52.0, 56.0,
				  60.0, 65.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0,
				  100.0, 110.0, 120.0, 130.0, 140.0, 150.0, 175.0,
				  200.0, 250.0, 350.0, 500.0, 1000.0};

//int nptbins( sizeof(ptlow)/sizeof(float) - 1 );

const float rochcor44X::zptscl[84] = {1.62964,1.53299,1.44088,1.33503,1.29242,1.13319,1.1201,1.10811,0.992511,0.956751,
				   0.935383,0.909322,0.90837,0.901406,0.883813,0.931082,0.898036,0.872295,0.925305,
				   0.963303,0.933956,0.915774,0.910455,0.956979,0.945336,0.969349,0.940201,0.955804,
				   0.950218,1.01371,0.97556,0.991332,0.939041,0.940316,0.976578,0.99464,0.974005,
				   1.0072,1.03932,0.969313,0.960051,1.01457,0.988141,0.994937,0.968738,0.984177,
				   1.03109,1.0367,0.912254,1.04971,0.970031,1.01293,1.00382,0.988483,0.976409,1.01115,
				   0.985687,0.989351,1.01611,1.00756,0.992071,1.01483,1.01444,1.03297,1.08866,1.10325,
				   1.06604,1.06214,1.12942,1.10811,1.11041,1.13956,1.16584,1.09633,1.24445,1.16436,
				   1.19486,1.19513,1.22895,1.18531,1.18177,1.12256,1.1672,1.87976};


const float rochcor44X::zptscler[84] = {0.0294984,0.0162434,0.0121944,0.0099485,0.0088135,0.00743117,0.00705711,0.00684279,
				     0.00616736,0.00596599,0.00589138,0.00579651,0.0058861,0.00596648,0.00598243,0.00636023,
				     0.00632113,0.00630161,0.00679044,0.00719776,0.00715072,0.00721491,0.00736719,0.00786873,
				     0.00796668,0.00834301,0.00831559,0.00860647,0.00874932,0.00946821,0.00937378,0.00971243,
				     0.00947482,0.00972364,0.0102102,0.0105725,0.0105773,0.0111158,0.0116094,0.0112022,0.0113484,
				     0.0120954,0.0120832,0.0124166,0.0123159,0.0127669,0.0134762,0.013815,0.012577,0.0145407,
				     0.00988852,0.0106237,0.0108213,0.0111293,0.0114568,0.00869239,0.00908969,0.00959648,0.0104104,
				     0.0109857,0.00823061,0.00927262,0.0101741,0.011348,0.0128945,0.012886,0.0140573,0.0155477,
				     0.0178927,0.0198073,0.0216724,0.0243028,0.0271627,0.0208322,0.0268699,0.0300166,0.0359204,
				     0.0418172,0.0334502,0.0452334,0.0489154,0.0651387,0.159474,0.528352};

rochcor44X::~rochcor44X(){
}

rochcor44X::rochcor44X(){
  
  eran.SetSeed(123456);
  sran.SetSeed(1234);
  
}

void rochcor44X::momcor_mc( TLorentzVector& mu, float charge, float sysdev){
  
  //sysdev == num : deviation = num

  float ptmu = mu.Pt();
  float muphi = mu.Phi();
  float mueta = mu.Eta(); // same with mu.Eta() in Root

  float px = mu.Px();
  float py = mu.Py();
  float pz = mu.Pz();
  float e = mu.E();

  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);

  float mptsys = sran.Gaus(0.0,sysdev);
  
  float dm = (mcor_bfA[mu_phibin][mu_etabin] + mptsys*mcor_bfAer[mu_phibin][mu_etabin])/mmavgA[mu_phibin][mu_etabin];
  float da = mcor_maA[mu_phibin][mu_etabin] + mptsys*mcor_maAer[mu_phibin][mu_etabin];

  float cor = 1.0/(1.0 + dm + charge*da*ptmu);

  //for the momentum tuning - eta,phi,Q correction
  px *= cor;
  py *= cor;
  pz *= cor;
  e *= cor;
  
  float recm = recmA;
  //float drecm = drecmA;
  
  float gscler = TMath::Sqrt( TMath::Power(mgsclA_stat,2) + TMath::Power(mgsclA_syst,2) );
  
  float gscl = (genm_smr/recm);
  
  px *= (gscl + sysdev*gscler);
  py *= (gscl + sysdev*gscler);
  pz *= (gscl + sysdev*gscler);
  e *= (gscl + sysdev*gscler);
  
  mu.SetPxPyPzE(px,py,pz,e);
  
}


void rochcor44X::momcor_data( TLorentzVector& mu, float charge, float sysdev){
    
  float ptmu = mu.Pt();

  float muphi = mu.Phi();
  float mueta = mu.Eta(); // same with mu.Eta() in Root

  float px = mu.Px();
  float py = mu.Py();
  float pz = mu.Pz();
  float e = mu.E();
  
  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  
  float mptsys1 = sran.Gaus(0.0,sysdev);
  
  float dm = (dcor_bfA[mu_phibin][mu_etabin] + mptsys1*dcor_bfAer[mu_phibin][mu_etabin])/dmavgA[mu_phibin][mu_etabin];
  float da = dcor_maA[mu_phibin][mu_etabin] + mptsys1*dcor_maAer[mu_phibin][mu_etabin];

  float cor = 1.0/(1.0 + dm + charge*da*ptmu);
  
  px *= cor;
  py *= cor;
  pz *= cor;
  e *= cor;
  
  //after Z pt correction
  
  float recm = drecmA;
  float gscler = TMath::Sqrt( TMath::Power(dgsclA_stat,2) + TMath::Power(dgsclA_syst,2) );
  
  float gscl = (genm_smr/recm);
  
  px *= (gscl + sysdev*gscler);
  py *= (gscl + sysdev*gscler);
  pz *= (gscl + sysdev*gscler);
  e *= (gscl + sysdev*gscler);
  
  mu.SetPxPyPzE(px,py,pz,e);
  
}

void rochcor44X::musclefit_data( TLorentzVector& mu, TLorentzVector& mubar){

  float dpar1 = 0.0;
  float dpar2 = 0.0;
  float epar1 = 0.0;
  float epar2 = 0.0;
  
  if(fabs(mu.PseudoRapidity())<=0.9){
    dpar1 = d0par;
    epar1 = e0par;
  }else if(mu.PseudoRapidity()>0.9){
    dpar1 = d1par;
    epar1 = e1par;
  }else if(mu.PseudoRapidity()<-0.9){
    dpar1 = d2par;
    epar1 = e2par;
  }

  if(fabs(mubar.PseudoRapidity())<=0.9){
    dpar2 = d0par;
    epar2 = e0par;
  }else if(mubar.PseudoRapidity()>0.9){
    dpar2 = d1par;
    epar2 = e1par;
  }else if(mubar.PseudoRapidity()<-0.9){
    dpar2 = d2par;
    epar2 = e2par;
  }

  float corr1 = 1.0 + bpar*mu.Pt() + (-1.0)*cpar*mu.Pt()*TMath::Sign(float(1.0),float(mu.PseudoRapidity()))*TMath::Power(mu.PseudoRapidity(),2)
    + (-1.0)*dpar1*mu.Pt()*sin(mu.Phi() + epar1);
  float corr2 = 1.0 + bpar*mubar.Pt() + (1.0)*cpar*mubar.Pt()*TMath::Sign(float(1.0),float(mubar.PseudoRapidity()))*TMath::Power(mubar.PseudoRapidity(),2)
    + (1.0)*dpar2*mubar.Pt()*sin(mubar.Phi() + epar2);
  
  float px1 = mu.Px();
  float py1 = mu.Py();
  float pz1 = mu.Pz();
  float e1 = mu.E();
  
  float px2 = mubar.Px();
  float py2 = mubar.Py();
  float pz2 = mubar.Pz();
  float e2 = mubar.E();

  px1 *= corr1;
  py1 *= corr1;
  pz1 *= corr1;
  e1 *= corr1;
  
  px2 *= corr2;
  py2 *= corr2;
  pz2 *= corr2;
  e2 *= corr2;
  
  mu.SetPxPyPzE(px1,py1,pz1,e1);
  mubar.SetPxPyPzE(px2,py2,pz2,e2);

}

Int_t rochcor44X::phibin(float phi){
  
  int nphibin = -1;
  
  for(int i=0; i<8; i++){
    if(-pi+(2.0*pi/8.0)*i <= phi && -pi+(2.0*pi/8.0)*(i+1) > phi){
      nphibin = i;
      break;
    }
  }
  
  return nphibin;
}

Int_t rochcor44X::etabin(float eta){

  int nbin = -1;
  
  for(int i=0; i<22; i++){
    if(netabin[i] <= eta && netabin[i+1] > eta){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}

float rochcor44X::zptcor(float gzpt) {
  int ibin( 0 );
  
  // mcptscl[] = 84 bins: [0] and [83] are the underflow and overflow
  if ( gzpt > ptlow[nptbins] ) return nptbins-1;
  if ( gzpt < ptlow[0      ] ) return 0;
  
  for ( int i=0; i<nptbins; ++i ) {
    if ( gzpt>=ptlow[i] && gzpt<ptlow[i+1] ) { ibin=i; break; }
  }

  float zptwt = zptscl[ibin];

  return zptwt;
}
