#include "CMGTools/HtoZZ2l2nu/interface/cleanEventAnalysis.h"
#include "FWCore/PythonParameterSet/interface/MakeParameterSets.h"
#include "PhysicsTools/UtilAlgos/interface/FWLiteAnalyzerWrapper.h"

typedef fwlite::AnalyzerWrapper<CleanEventAnalysis> WrappedFWLiteCleanEventAnalyzer;

int main(int argc, char* argv[]) 
{
  // load framework libraries
  gSystem->Load( "libFWCoreFWLite" );
  AutoLibraryLoader::enable();
  
  // only allow one argument for this simple example which should be the python cfg file
  if ( argc < 2 ) {
    std::cout << "Usage : " << argv[0] << " [parameters.py]" << std::endl;
    return 0;
  }
  if( !edm::readPSetsFrom(argv[1])->existsAs<edm::ParameterSet>("process") )
    {
      std::cout << " ERROR: ParametersSet 'plot' is missing in your configuration file" << std::endl; 
      exit(0);
    }

  WrappedFWLiteCleanEventAnalyzer an(edm::readPSetsFrom(argv[1])->getParameter<edm::ParameterSet>("process"), std::string("evAnalyzer"));
  an.beginJob();
  an.analyze();
  an.endJob();
  return 0;
}
